<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Account</title>

<style>
*,*::before,*::after{
  box-sizing:border-box;
}

body{
  margin:0;
  background:linear-gradient(180deg,#1a1a1a,#0f0f0f);
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
  color:#fff;
  min-height:100vh;
}

/* ===== Header ===== */
.header{
  height:60px;
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
  border-bottom:2px solid #242424;
}
.header::after{
  content:"";
  position:absolute;
  left:0; right:0; bottom:-2px;
  height:2px;
  background:linear-gradient(90deg,#9a7bff,#ffaf7b);
  opacity:.35;
}
.header-title{
  font-size:20px;
  font-weight:700;
}

/* Back button */
.back-btn{
  position:absolute;
  left:14px;
  top:50%;
  transform:translateY(-50%);
  width:34px;
  height:34px;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}
.back-btn svg{
  width:18px;
  height:18px;
  stroke:#fff;
  stroke-width:2.4;
}

/* ===== Content ===== */
.container{
  max-width:420px;
  margin:0 auto;
  padding:26px 18px;
}

/* ===== Card ===== */
.card{
  background:#1f1f1f;
  border-radius:18px;
  padding:18px;
  margin-bottom:14px;
}

/* User info */
.user-id{
  font-size:14px;
  color:#bdbdbd;
}
.username{
  font-size:20px;
  font-weight:700;
  margin-top:4px;
}

/* Menu */
.menu-item{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:14px 2px;
  font-size:15px;
  cursor:pointer;
}
.menu-item + .menu-item{
  border-top:1px solid #2a2a2a;
}
.menu-item span{
  color:#34d399;
}

/* Logout */
.logout-btn{
  width:100%;
  height:52px;
  border-radius:26px;
  border:none;
  background:#ff6b6b;
  color:#000;
  font-weight:700;
  font-size:15px;
  margin-top:10px;
}
.logout-btn:active{
  transform:scale(.98);
}
</style>
</head>

<body>

<!-- Header -->
<div class="header">
  <div class="back-btn" onclick="location.href='index.html'">
    <svg viewBox="0 0 24 24" fill="none">
      <path d="M15 18l-6-6 6-6"/>
    </svg>
  </div>
  <div class="header-title">Account</div>
</div>

<div class="container">

  <!-- User Info -->
  <div class="card">
    <div class="user-id">User ID</div>
    <div class="username" id="username">--</div>
  </div>

  <!-- Menu -->
  <div class="card">
    <div class="menu-item" onclick="goChangePwd()">
      Change Password
      <span>›</span>
    </div>
    <div class="menu-item" onclick="goSecurity()">
      Security Settings
      <span>›</span>
    </div>
  </div>

  <!-- Logout -->
  <button class="logout-btn" onclick="logout()">Logout</button>

</div>

<script>
const API_BASE = "https://bcr-backend-kov7.onrender.com";
  
/* ===== Login Guard ===== */
const token = localStorage.getItem("token");
if(!token){
  location.replace("login.html");
}

/* ===== Load User From API ===== */
fetch(`${API_BASE}/api/me`, {
  headers: {
    Authorization: "Bearer " + token
  }
})
.then(res => {
  if(res.status === 401){
    // token 失效
    localStorage.removeItem("token");
    localStorage.removeItem("username");
    location.replace("login.html");
    throw new Error("Unauthorized");
  }
  return res.json();
})
.then(user => {
  document.getElementById("username").innerText = user.username;
})
.catch(err => {
  console.error(err);
});

/* ===== Actions ===== */
function logout(){
  localStorage.removeItem("token");
  localStorage.removeItem("username");
  location.replace("index.html");
}

function goChangePwd(){
  alert("Go to change password page");
}

function goSecurity(){
  alert("Go to security settings");
}
</script>

</body>
</html>
